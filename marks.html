<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marks</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="navbar">
        <img src="images/logo.png" alt="Portal Logo" class="logo">
        <a href="home.html">Home</a>
        <a href="admission.html">Admission</a>
        <a href="attendance.html">Attendance</a>
        <a href="marks.html">Marks</a>
        <a href="announcements.html">Announcements</a>
        <a href="library.html">Library</a>
        <a href="support.html">Support</a>
        <a href="settings.html">Settings</a>
    </div>

    <div class="content-container">
        <h2>Your Marks</h2>
        <table id="marks-table">
            <thead>
                <tr>
                    <th>Subject</th>
                    <th>Marks</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Software Engineering</td>
                    <td>78</td>
                </tr>
                <tr>
                    <td>Network Security</td>
                    <td>82</td>
                </tr>
                <tr>
                    <td>Cybersecurity Fundamentals</td>
                    <td>88</td>
                </tr>
            </tbody>
        </table>
        <div class="action-buttons">
            <a href="#" class="btn" onclick="downloadMarksheet()">Download Marksheet</a>
            <a href="#" class="btn">Contact Subject Teacher</a>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script> <!-- Add XLSX library -->
    <script>
        function downloadMarksheet() {
            const username = prompt("Enter your login username:");
            if (!username) {
                alert("Username is required to download the marksheet.");
                return;
            }

            // Create a worksheet from the marks
            const ws_data = [
                ["Subject", "Marks"],
                ["Software Engineering", 78],
                ["Network Security", 82],
                ["Cybersecurity Fundamentals", 88]
            ];

            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.aoa_to_sheet(ws_data);

            XLSX.utils.book_append_sheet(wb, ws, "Marks");

            // Add username to the filename
            const filename = `${username}_marksheet.xlsx`;

            XLSX.writeFile(wb, filename);
        }
    </script>
</body>
</html>
